<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>贪吃蛇</title>
<style>
*{margin:0;padding:0;}
html,body{width:100%;height:100%;overflow:hidden;}
body{background:#1a1a2e;display:flex;flex-direction:column;align-items:center;justify-content:center;font-family:Arial,tahoma,sans-serif;touch-action:none;-webkit-touch-callout:none;-webkit-user-select:none;user-select:none;}
#wrap{width:300px;text-align:center;}
#c{background:#0a0a1a;border:2px solid #4ecdc4;border-radius:4px;}
#btn{display:block;width:100%;margin-top:15px;padding:12px;font-size:16px;background:#4ecdc4;border:none;border-radius:4px;color:#fff;cursor:pointer;}
#msg{color:#888;font-size:12px;margin-top:10px;}
</style>
</head>
<body>
<div id="wrap"><canvas id="c" width="300" height="300"></canvas><button id="btn">点击开始游戏</button><p id="msg">点击屏幕左半边← →点击屏幕右半边</p></div>
<script>
// 游戏变量
var c=document.getElementById('c'),ctx=c.getContext('2d'),btn=document.getElementById('btn'),msg=document.getElementById('msg');
var s=[{x:10,y:10},{x:9,y:10},{x:8,y:10}],f={x:5,y:5},d={x:1,y:0},sc=0,r=false,to=null;

// 初始化
function init(){s=[{x:10,y:10},{x:9,y:10},{x:8,y:10}];d={x:1,y:0};sc=0;placeF();draw();btn.innerText='点击开始游戏';msg.innerText='点击屏幕左半边← →点击屏幕右半边';}

// 放置食物
function placeF(){var ok=false;while(!ok){f={x:Math.floor(Math.random()*15),y:Math.floor(Math.random()*15)};ok=true;for(var i=0;i<s.length;i++)if(s[i].x==f.x&&s[i].y==f.y)ok=false;}}

// 绘制
function draw(){ctx.fillStyle='#0a0a1a';ctx.fillRect(0,0,300,300);ctx.fillStyle='#4ecdc4';for(var i=0;i<s.length;i++)ctx.fillRect(s[i].x*20+1,s[i].y*20+1,18,18);ctx.fillStyle='#ff6b6b';ctx.fillRect(f.x*20+2,f.y*20+2,16,16);}

// 游戏循环
function loop(){if(!r)return;var h={x:s[0].x+d.x,y:s[0].y+d.y};if(h.x<0||h.x>=15||h.y<0||h.y>=15||s.some(function(x){return x.x==h.x&&x.y==h.y})){end();return;}s.unshift(h);if(h.x==f.x&&h.y==f.y){sc+=10;placeF();}else{s.pop();}draw();to=setTimeout(loop,150);}

// 开始
function start(){if(r)return;r=true;init();loop();btn.innerText='游戏中...';btn.disabled=true;}

// 结束
function end(){r=false;if(to)clearTimeout(to);btn.disabled=false;btn.innerText='重新开始';ctx.fillStyle='rgba(0,0,0,0.8)';ctx.fillRect(0,0,300,300);ctx.fillStyle='#fff';ctx.font='20px Arial';ctx.textAlign='center';ctx.fillText('游戏结束',150,150);ctx.font='14px Arial';ctx.fillText('得分:'+sc,150,175);}

// 控制
function left(){if(d.x!=1)d={x:-1,y:0};}
function right(){if(d.x!=-1)d={x:1,y:0};}

// 触摸事件
document.body.addEventListener('touchstart',function(e){e.preventDefault();var x=e.touches[0].clientX;window.tx=x;},false);
document.body.addEventListener('touchend',function(e){e.preventDefault();if(!r){start();return;}var x=e.changedTouches[0].clientX;if(Math.abs(x-window.tx)>20){if(x>window.tx)right();else left();}else{if(x<window.innerWidth/2)left();else right();}},false);

// 点击事件
document.body.addEventListener('click',function(e){if(!r){start();return;}var x=e.clientX;if(x<window.innerWidth/2)left();else right();});

// 键盘事件
document.addEventListener('keydown',function(e){if(e.key=='ArrowLeft')left();if(e.key=='ArrowRight')right();});

// 按钮
btn.onclick=start;

// 开始
init();
</script>
</body>
</html>
